# AI-DLC テストカバレッジ分析コマンド

## 概要
テストカバレッジを分析し、80%以上のカバレッジを達成していることを確認します。

## 使用方法
```
/aidlc-test-coverage
```

## 実行内容
1. テストスイートを実行
2. カバレッジレポートを生成
3. カバレッジを分析（80%以上を目標）
4. カバーされていない領域を特定
5. 追加テストの推奨を生成

## AIエージェントへの指示

あなたはTest Coverageコマンドの実行エージェントです。

### ステップ1: テストの実行
1. テストスイートを実行：
   ```bash
   npm run test:coverage
   ```
2. カバレッジレポートを生成
3. 結果を記録

### ステップ2: カバレッジの分析
1. カバレッジレポートを読み込む
2. 以下の指標を確認：
   - **Branches**: 80%以上
   - **Functions**: 80%以上
   - **Lines**: 80%以上
   - **Statements**: 80%以上
3. カバーされていない領域を特定

### ステップ3: レポートの作成
1. カバレッジ結果を整理：
   - 全体のカバレッジ率
   - 各ファイルのカバレッジ率
   - カバーされていない行
   - カバーされていない関数
2. 80%未満のファイルをリストアップ
3. 追加テストの推奨を生成

### ステップ4: 結果の提示
1. カバレッジレポートをユーザーに提示
2. 80%未満の場合、追加テストの推奨を提示
3. ユーザーに結果を提示

### ステップ5: 承認待ち
1. **ユーザーの承認または指示を待つ。回答が得られるまで次のステップに進まない。**
2. 80%未満の場合、追加テストの作成を推奨
3. ユーザーからの指示に基づいて追加テストを作成するか、次のフェーズに進む

## カバレッジ要件

### 最小要件: 80%

- **Branches**: 80%以上
- **Functions**: 80%以上
- **Lines**: 80%以上
- **Statements**: 80%以上

### カバレッジレポートの確認

```bash
# カバレッジ付きでテストを実行
npm run test:coverage

# HTMLレポートを表示
open coverage/lcov-report/index.html
```

## テストタイプ

1. **ユニットテスト** - 個別の関数、ユーティリティ、コンポーネント
2. **統合テスト** - APIエンドポイント、データベース操作
3. **E2Eテスト** - 重要なユーザーフロー（Playwright推奨）

## アーティファクト

- カバレッジレポート（HTML形式）
- カバレッジ分析結果
- 追加テストの推奨リスト

## 注意事項

- **重要**: 各ステップでユーザーの回答や承認が必要な場合は、必ずユーザーの回答を待ってから次のステップに進むこと。先に進まないこと。
- 80%未満のカバレッジの場合、コード生成を完了しない
- カバレッジ分析は、すべてのコード生成後に自動的に実行されることを推奨
- カバレッジ結果は、次のフェーズに進む前に確認が必要
