---
description: テスト要件。80%の最小カバレッジ、TDDワークフロー、テストタイプの定義。
globs: ["**/*.test.ts", "**/*.test.tsx", "**/*.spec.ts", "**/*.spec.tsx", "**/tests/**", "**/__tests__/**"]
alwaysApply: true
type: always
---

# テスト要件

## 最小テストカバレッジ: 80%

**必須テストタイプ**:
1. **ユニットテスト** - 個別の関数、ユーティリティ、コンポーネント
2. **統合テスト** - APIエンドポイント、データベース操作
3. **E2Eテスト** - 重要なユーザーフロー（Playwright推奨）

## テスト駆動開発（TDD）

**必須ワークフロー**:
1. テストを先に書く（RED）
2. テストを実行 - 失敗するはず
3. 最小限の実装を書く（GREEN）
4. テストを実行 - 成功するはず
5. リファクタリング（IMPROVE）
6. カバレッジを確認（80%以上）

## テスト失敗のトラブルシューティング

1. **TDD専門家として行動**（`aidlc-code-generation`コマンド内、ステップ7）
2. テストの分離を確認
3. モックが正しいか確認
4. テストではなく実装を修正（テストが間違っている場合を除く）

## 専門家の役割サポート

- **TDD専門家** - `aidlc-code-generation`コマンド内に統合、新機能に積極的に使用、テストファーストを強制
- **E2Eテスト専門家** - Playwright E2Eテスト専門家（将来実装予定）

## AI-DLC統合

- **Code Generationコマンド**: すべてのコード生成時にユニットテストを自動生成
- **テストカバレッジ**: 80%以上のカバレッジを達成するまでコード生成を完了しない
- **TDDワークフロー**: `aidlc-code-generation`コマンドでTDDを強制
