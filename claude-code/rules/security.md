---
paths:
  - "**/*.ts"
  - "**/*.tsx"
  - "**/*.js"
  - "**/*.jsx"
  - "**/*.py"
  - "**/*.go"
---

# セキュリティガイドライン

## 必須セキュリティチェック

**コミット前の必須チェック**:
- [ ] ハードコードされた秘密情報がない（APIキー、パスワード、トークン）
- [ ] すべてのユーザー入力が検証されている
- [ ] SQLインジェクション対策（パラメータ化クエリ）
- [ ] XSS対策（HTMLのサニタイズ）
- [ ] CSRF保護が有効
- [ ] 認証/認可が検証されている
- [ ] すべてのエンドポイントにレート制限
- [ ] エラーメッセージが機密データを漏洩しない

## 秘密情報の管理

```typescript
// ❌ 禁止: ハードコードされた秘密情報
const apiKey = "sk-proj-xxxxx"

// ✅ 推奨: 環境変数
const apiKey = process.env.OPENAI_API_KEY

if (!apiKey) {
  throw new Error('OPENAI_API_KEY not configured')
}
```

## セキュリティ問題発見時の対応

セキュリティ問題が見つかった場合:
1. **即座に停止**
2. **セキュリティ専門家として行動**（`/aidlc-security-review` コマンドまたは `/aidlc-code-generation` コマンド内、ステップ11）
3. **CRITICAL**問題を修正してから続行
4. 漏洩した秘密情報をローテーション
5. 類似の問題がないかコードベース全体をレビュー

## AI-DLC統合

- **Construction Phase**: コード生成時に自動的にセキュリティチェックを実行
- **Code Generationコマンド**: 生成されたコードに対して自動的にセキュリティレビューを実行
- **デプロイ前**: すべてのセキュリティチェックをパスする必要がある
